<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Login | FinAccess</title>

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Secure access to FinAccess for borrowers and lenders. Phone-based verification with enterprise-grade security." />

  <style>
    body {
      margin: 0;
      font-family: Inter, system-ui, -apple-system, BlinkMacSystemFont;
      background: linear-gradient(180deg, #f8fafc, #eef2ff);
      color: #0f172a;
      display: flex;
      min-height: 100vh;
    }

    .container {
      display: grid;
      grid-template-columns: 1.1fr 1fr;
      width: 100%;
    }

    /* LEFT BRAND PANEL */
    .brand {
      padding: 80px;
      background: radial-gradient(circle at top, #020617, #020617 60%);
      color: #e5e7eb;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    .brand h1 {
      font-size: 40px;
      margin-bottom: 14px;
      letter-spacing: -0.5px;
    }

    .brand p {
      color: #94a3b8;
      max-width: 440px;
      font-size: 16px;
      line-height: 1.6;
    }

    .brand ul {
      margin-top: 44px;
      padding-left: 18px;
      color: #cbd5f5;
    }

    .brand li {
      margin-bottom: 14px;
      font-size: 15px;
    }

    /* LOGIN PANEL */
    .login {
      padding: 80px;
      background: white;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .card {
      width: 100%;
      max-width: 420px;
    }

    .card h2 {
      font-size: 28px;
      margin-bottom: 6px;
    }

    .card p {
      color: #64748b;
      margin-bottom: 30px;
      font-size: 15px;
      line-height: 1.5;
    }

    label {
      display: block;
      font-size: 13px;
      margin-bottom: 6px;
      color: #475569;
    }

    input {
      width: 100%;
      padding: 14px;
      font-size: 15px;
      border-radius: 10px;
      border: 1px solid #cbd5f5;
      margin-bottom: 18px;
      outline: none;
      transition: border .15s, box-shadow .15s;
    }

    input:focus {
      border-color: #2563eb;
      box-shadow: 0 0 0 3px rgba(37,99,235,.15);
    }

    button {
      width: 100%;
      padding: 14px;
      font-size: 15px;
      font-weight: 600;
      border-radius: 10px;
      border: none;
      cursor: pointer;
      transition: background .15s, opacity .15s;
    }

    button:disabled {
      opacity: .6;
      cursor: not-allowed;
    }

    .btn-primary {
      background: #2563eb;
      color: white;
    }

    .btn-primary:hover:not(:disabled) {
      background: #1e40af;
    }

    .secondary {
      text-align: center;
      margin-top: 18px;
      font-size: 13px;
      color: #64748b;
    }

    .secondary span {
      font-weight: 600;
      color: #0f172a;
    }

    .otp-section {
      display: none;
    }

    .status {
      font-size: 13px;
      margin-top: 12px;
      min-height: 18px;
    }

    .status.error {
      color: #dc2626;
    }

    .status.success {
      color: #16a34a;
    }

    .footer-note {
      margin-top: 40px;
      font-size: 12px;
      color: #94a3b8;
      text-align: center;
      line-height: 1.5;
    }

    .footer-note strong {
      color: #475569;
      font-weight: 500;
    }

    @media (max-width: 900px) {
      .container {
        grid-template-columns: 1fr;
      }
      .brand {
        display: none;
      }
      .login {
        padding: 40px 24px;
      }
    }
  </style>
</head>

<body>

<div class="container">

  <!-- LEFT -->
  <div class="brand">
    <h1>FinAccess</h1>
    <p>
      A consent-driven credit intelligence platform that helps borrowers
      discover eligibility while enabling banks and NBFCs to acquire
      verified, compliant demand.
    </p>

    <ul>
      <li>Explainable eligibility decisions</li>
      <li>Secure, permissioned document sharing</li>
      <li>Qualified lender-side lead flow</li>
      <li>Audit-ready & regulator-friendly architecture</li>
    </ul>
  </div>

  <!-- RIGHT -->
  <div class="login">
    <div class="card">

      <h2>Secure Login</h2>
      <p>
        Verify your mobile number to access your borrower or lender workspace.
        No passwords. No spam.
      </p>

      <!-- STEP 1 -->
      <div id="step-mobile">
        <label>Registered Mobile Number (India)</label>
        <input
          type="tel"
          id="mobile"
          placeholder="10-digit mobile number"
          maxlength="10"
          inputmode="numeric"
          autocomplete="tel"
        />
        <div id="recaptcha"></div>
        <button class="btn-primary" id="sendBtn" onclick="sendOTP()">Send OTP</button>
      </div>

      <!-- STEP 2 -->
      <div id="step-otp" class="otp-section">
        <label>Enter One-Time Password</label>
        <input
          type="text"
          id="otp"
          placeholder="6-digit OTP"
          inputmode="numeric"
        />
        <button class="btn-primary" id="verifyBtn" onclick="verifyOTP()">Verify & Continue</button>
      </div>

      <div id="status" class="status"></div>

      <div class="secondary">
        By continuing, you agree to our
        <span>Terms of Service</span> and <span>Privacy Policy</span>
      </div>

      <div class="footer-note">
        <strong>Important:</strong> FinAccess does not lend, underwrite, or
        make credit decisions. We act solely as a technology and consent
        orchestration platform.
      </div>

    </div>
  </div>

</div>

<script>
  const API_BASE = "https://my-finaccess.workers.dev"; // backend worker

  const statusEl = document.getElementById("status");

  function setStatus(msg, type) {
    statusEl.textContent = msg || "";
    statusEl.className = "status " + (type || "");
  }

  async function sendOTP() {
    const rawMobile = document.getElementById("mobile").value.trim();

    if (!/^[6-9]\d{9}$/.test(rawMobile)) {
      setStatus("Enter a valid 10-digit Indian mobile number.", "error");
      return;
    }

    document.getElementById("sendBtn").disabled = true;
    setStatus("Sending OTP…");

    const res = await fetch(`${API_BASE}/auth/otp/request`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ mobile: rawMobile })
    });

    if (!res.ok) {
      setStatus("Failed to send OTP. Please try again.", "error");
      document.getElementById("sendBtn").disabled = false;
      return;
    }

    document.getElementById("step-mobile").style.display = "none";
    document.getElementById("step-otp").style.display = "block";
    setStatus("OTP sent successfully.", "success");
  }

  async function verifyOTP() {
    const mobile = document.getElementById("mobile").value.trim();
    const otp = document.getElementById("otp").value.trim();

    document.getElementById("verifyBtn").disabled = true;
    setStatus("Verifying…");

    const res = await fetch(`${API_BASE}/auth/otp/verify`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ mobile, otp })
    });

    const data = await res.json();

    if (!data.session_id) {
      setStatus("Invalid OTP. Please try again.", "error");
      document.getElementById("verifyBtn").disabled = false;
      return;
    }

    localStorage.setItem("session_id", data.session_id);
    window.location.href = "/dashboard.html";
  }
</script>

</body>
</html>
